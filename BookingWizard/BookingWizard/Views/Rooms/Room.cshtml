@using Microsoft.Extensions.Localization;
@using BookingWizard.ModelsVM.HotelRooms;
@model HotelRoomVM

<div class="container">
	<div class="row">
		<div class="col-md-6 mb-3">
			@if (TempData["OnePhotoLeft"] != null)
			{
				<div class="alert alert-danger" style="width: 400px; height: 60px;">
					<span id="alertMessage">@TempData["OnePhotoLeft"]</span>
				</div>
			}
			<div id="photoContainer" class="mt-3">
				<img src="/PhotoRooms/GetPhoto/@Model.Image.Id" class="img-fluid" style="height: 400px;" />
			</div>
			<div class="text-center mt-3">
				<button type="button" id="prevButton" class="btn btn-primary"><i></i></button>
				<button type="button" id="nextButton" class="btn btn-primary"><i></i></button>
				@if (User.IsInRole("Owner"))
				{
					<button type="button" id="deletePhotoButton" class="btn btn-danger"><i></i></button>
					<button type="button" id="addButton" class="btn btn-success"><i></i></button>
					<input type="file" id="photoInput" style="display: none;" accept="image/*" multiple>
				}
			</div>
		</div>
		<div class="col-md-6">
			<div class="text-center">
				<h1 class="display-4">@Model.Name</h1>
				<div class="lead">@Model.Description</div>
				<p class="lead">@Model.roomPricePerNight.ToString("c")</p>
				<p class="lead">
					@foreach (var item in Model.PrivilegesList)
					{
						@item.Privilege
						@if (!item.Equals(Model.PrivilegesList.Last()))
						{
							<span>,</span>
						}
					}
				</p>
			</div>
		</div>
	</div>
</div>

@if (User.IsInRole("Owner"))
{
	<form method="post" action="/Rooms/Delete">
		<input type="hidden" asp-for="Id" /> 
		<button class="alert alert-danger" type="submit" id="deleteButton">@Localizer["DeleteRoom"]</button> 
	</form>
}
@if (User.IsInRole("Guest"))
{
	<a href="@Url.Action("Booking", "Booking", new { id = Model.Id })" class="btn btn-primary m-3">@Localizer["Book"]</a>


	@if (TempData["MessageFromBooking"] != null)
	{
		var serializedString = TempData["MessageFromBooking"] as string;
		var localizedString = new LocalizedString("MessageFromBooking", serializedString); 
		<div> <span class="alert alert-primary">@localizedString</span> </div>
	}
}

<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>


@{
	var sureDeleteLocalize = Localizer["SureDelete"];
}

<script>
	var photos = @Html.Raw(Json.Serialize(Model.Images.Select(u => u).ToArray()));
	var model = @Html.Raw(Json.Serialize(Model));
	var sureDelete = @Html.Raw(Json.Serialize(sureDeleteLocalize.Value));
</script>

<script src="~/Scripts/PhotoRooms.js?v=2.1"></script>

<style>
	/* Add your custom styles here */
	.btn-group {
		margin-bottom: 10px;
	}

	.form-label {
		font-weight: bold;
	}
</style>